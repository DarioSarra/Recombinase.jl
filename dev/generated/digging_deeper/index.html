<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Digging deeper · Recombinase.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Recombinase.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Index</a></li><li><a class="toctext" href="../tutorial/">Tutorial</a></li><li><a class="toctext" href="../../interactive_interface/">Interactive interface</a></li><li class="current"><a class="toctext" href>Digging deeper</a><ul class="internal"><li><a class="toctext" href="#Analysis-functions-1">Analysis functions</a></li><li><a class="toctext" href="#OnlineStats-integration-1">OnlineStats integration</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Digging deeper</a></li></ul><a class="edit-page" href="https://github.com/piever/Recombinase.jl/blob/master/docs/src/digging_deeper.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Digging deeper</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Digging-deeper-1" href="#Digging-deeper-1">Digging deeper</a></h1><p>The core functioning of Recombinase is based on a set of preimplemented analysis functions and on the <a href="https://github.com/joshday/OnlineStats.jl">OnlineStats</a> package to compute summary statistics efficiently.</p><h2><a class="nav-anchor" id="Analysis-functions-1" href="#Analysis-functions-1">Analysis functions</a></h2><p>Under the hood, the actual computations are implemented in some built-in <code>Analysis</code> objects. Each <code>Analysis</code> takes some vectors (a varying number, one for <code>density</code> and two for <code>prediction</code> for example), an optional <code>axis</code> argument to specify the <code>x</code> axis argument and returns an iterator of <code>(x, y)</code> values, representing the <code>y</code> value corresponding to each point of the <code>x</code> axis.</p><pre><code class="language-julia">using Recombinase: density, hazard, cumulative, prediction
x = randn(100)
res = density(x)
collect(Iterators.take(res, 5)) # let&#39;s see the first few elements</code></pre><pre><code class="language-none">5-element Array{Tuple{Float64,Float64},1}:
 (-2.9585308372146755, 0.024965004165463458)
 (-2.899551728000507, 0.026180556259019484) 
 (-2.8405726187863385, 0.026736443188934568)
 (-2.78159350957217, 0.026710766176206113)  
 (-2.722614400358002, 0.02627803730807635)  </code></pre><p>We can collect the iterator in a table container to see that we recover the <code>x</code> and <code>y</code> axis, ready for plotting</p><pre><code class="language-julia">using JuliaDB
s = table(res)</code></pre><pre><code class="language-none">Table with 100 rows, 2 columns:
1         2
───────────────────
-2.95853  0.024965
-2.89955  0.0261806
-2.84057  0.0267364
-2.78159  0.0267108
-2.72261  0.026278
-2.66364  0.0256878
-2.60466  0.0252298
-2.54568  0.0251928
-2.4867   0.0258246
⋮
2.46755   0.0250348
2.52653   0.0242304
2.58551   0.0236838
2.64448   0.0231943
2.70346   0.0225994
2.76244   0.0217824
2.82142   0.0206744
2.8804    0.0192533</code></pre><p><code>prediction</code> is similar but requrires two arguments:</p><pre><code class="language-julia">xs = 10 .* rand(100)
ys = sin.(xs) .+ 0.5 .* rand(100)

res = prediction(xs, ys)
table(res)</code></pre><pre><code class="language-none">Table with 98 rows, 2 columns:
1         2
────────────────────
0.140691  0.673024
0.241051  0.705249
0.34141   0.733018
0.44177   0.756253
0.54213   0.775178
0.642489  0.789877
0.742849  0.800405
0.843208  0.807207
0.943568  0.810384
⋮
9.17306   0.565143
9.27342   0.472203
9.37377   0.372356
9.47413   0.26561
9.57449   0.152067
9.67485   0.0318063
9.77521   -0.0952482
9.87557   -0.229104</code></pre><p>The function <code>discrete</code> can turn any analysis into its discrete counter-part (analyses are continuous for numerical axes and discrete otherwise by default). It also automatically comutes the error of the prediction (s.e.m).</p><pre><code class="language-julia">using Recombinase: discrete

x = rand(1:3, 1000)
y = rand(1000) .+ 0.1 .* x

res = discrete(prediction)(x, y)
table(res)</code></pre><pre><code class="language-none">Table with 3 rows, 2 columns:
1  2
────────────────────────
1  (0.581739, 0.0146647)
2  (0.694483, 0.0163167)
3  (0.818481, 0.0157399)</code></pre><h2><a class="nav-anchor" id="OnlineStats-integration-1" href="#OnlineStats-integration-1">OnlineStats integration</a></h2><p>Summary statistics are computed using the excellent <a href="https://github.com/joshday/OnlineStats.jl">OnlineStats</a> package. First the data is split by the splitting variable (in this case <code>School</code>), then the analysis is computed on each split chunk on the selected column(s). Finally the results from different schools are put together in summary statistics (default is <code>mean</code> and <code>s.e.m</code>):</p><pre><code class="language-julia">using Recombinase: datafolder, compute_summary
data = loadtable(joinpath(datafolder, &quot;school.csv&quot;))
compute_summary(density, data, :School; select = :MAch)</code></pre><pre><code class="language-none">100-element StructArrays.StructArray{Tuple{Float64,Tuple{Float64,Float64}},1,NamedTuple{(:x1, :x2),Tuple{Array{Float64,1},StructArrays.StructArray{Tuple{Float64,Float64},1,NamedTuple{(:x1, :x2),Tuple{Array{Float64,1},Array{Float64,1}}}}}}}:
 (-2.832, (0.007095095625459628, 0.0005825497483108032))             
 (-2.550939393939394, (0.007838324051760595, 0.0006260574836083454)) 
 (-2.269878787878788, (0.008619592372159876, 0.0006696627630044319)) 
 (-1.9888181818181818, (0.009438313664963307, 0.0007134192242440505))
 (-1.7077575757575758, (0.010293824814249444, 0.0007574849542421938))
 (-1.4266969696969698, (0.011185676423288606, 0.0008020675411028164))
 (-1.1456363636363636, (0.01211335769099234, 0.0008474013402249302)) 
 (-0.8645757575757576, (0.01307621450967119, 0.0008936976283633891)) 
 (-0.5835151515151515, (0.014073305125439826, 0.0009410934724699248))
 (-0.3024545454545455, (0.015103285160103232, 0.000989599947597033)) 
 ⋮                                                                   
 (22.744515151515152, (0.030139050666702846, 0.0014970627285730306)) 
 (23.02557575757576, (0.028632688481218565, 0.0014533685239022608))  
 (23.306636363636365, (0.02704926915097793, 0.0014012627830656734))  
 (23.58769696969697, (0.025399256774123875, 0.001340841300777614))   
 (23.868757575757577, (0.023696502599550594, 0.0012724899216037388)) 
 (24.149818181818183, (0.02195754966684903, 0.0011970079579388833))  
 (24.43087878787879, (0.02020131354820369, 0.0011156135636389236))   
 (24.711939393939392, (0.018448259380673813, 0.0010299231340946513)) 
 (24.993, (0.016719486604897808, 0.0009418573882592296))             </code></pre><p>The computation of the summary statistic works in two steps. First statistics from the keyword argument <code>estimator = (Mean, Variance)</code> of <code>compute_summary</code> are computed online, then the function from a keyword argument <code>postprocess = (nobs, mean, var) -&gt; (mean, sqrt(var / nobs))</code> turn this statistics into values we plot (<code>mean</code> and <code>s.e.m</code>). <code>postprocess</code> needs to take one more argument than the number of statistics of <code>estimator</code> (the number of observations, which is the first argument). To compute a different error bar (for example just the standard deviation) you can simply do:</p><pre><code class="language-julia">compute_summary(density, data, :School; select = :MAch, postprocess = (nobs, mean, var) -&gt; (mean, sqrt(var)))</code></pre><pre><code class="language-none">100-element StructArrays.StructArray{Tuple{Float64,Tuple{Float64,Float64}},1,NamedTuple{(:x1, :x2),Tuple{Array{Float64,1},StructArrays.StructArray{Tuple{Float64,Float64},1,NamedTuple{(:x1, :x2),Tuple{Array{Float64,1},Array{Float64,1}}}}}}}:
 (-2.832, (0.007095095625459628, 0.007368736220079861))             
 (-2.550939393939394, (0.007838324051760595, 0.007919070377583607)) 
 (-2.269878787878788, (0.008619592372159876, 0.008470638381182187)) 
 (-1.9888181818181818, (0.009438313664963307, 0.009024118700646464))
 (-1.7077575757575758, (0.010293824814249444, 0.009581510994855026))
 (-1.4266969696969698, (0.011185676423288606, 0.01014544106870248)) 
 (-1.1456363636363636, (0.01211335769099234, 0.010718873309560163)) 
 (-0.8645757575757576, (0.01307621450967119, 0.011304480180476032)) 
 (-0.5835151515151515, (0.014073305125439826, 0.011903995456487714))
 (-0.3024545454545455, (0.015103285160103232, 0.012517559227159587))
 ⋮                                                                  
 (22.744515151515152, (0.030139050666702846, 0.018936512089748853)) 
 (23.02557575757576, (0.028632688481218565, 0.018383819260512052))  
 (23.306636363636365, (0.02704926915097793, 0.017724727979655797))  
 (23.58769696969697, (0.025399256774123875, 0.016960449965120635))  
 (23.868757575757577, (0.023696502599550594, 0.016095865807507662)) 
 (24.149818181818183, (0.02195754966684903, 0.015141086097735608))  
 (24.43087878787879, (0.02020131354820369, 0.014111519398704812))   
 (24.711939393939392, (0.018448259380673813, 0.013027611674552471)) 
 (24.993, (0.016719486604897808, 0.01191365831182679))              </code></pre><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../../interactive_interface/"><span class="direction">Previous</span><span class="title">Interactive interface</span></a></footer></article></body></html>
